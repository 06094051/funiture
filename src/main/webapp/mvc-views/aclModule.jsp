<%@ page contentType="text/html;charset=UTF-8" language="java" %><html><head>    <title>权限管理</title></head><body><div id="aclModuleList">正在努力加载权限信息...</div><div id="aclList"></div><script id="aclModuleListFirstTemplate" type="x-tmpl-mustache"><ul>    {{#aclModuleList}}    <li><a id="aclModule_{{id}}" href="javascript:void(0)" data-id="{{id}}" class="aclModule-name">{{name}}</a></li>    {{/aclModuleList}}</ul></script><script id="aclModuleListNextTemplate" type="x-tmpl-mustache"><ul>    {{#aclModuleList}}    <li><a id="aclModule_{{id}}" href="javascript:void(0)" data-id="{{id}}" class="aclModule-name">{{name}}</a></li>    {{/aclModuleList}}</ul></script><script id="aclListTemplate" type="x-tmpl-mustache"><ul>    {{#aclList}}    <li><a href="javascript:void(0)" data-id="{{id}}" class="acl-name">{{name}}-{{id}}</a></li>    {{/aclList}}</ul></script><script type="text/javascript" src="/js/jquery-1.7.2.min.js"></script><script type="text/javascript" src="http://cdn.bootcss.com/mustache.js/2.2.1/mustache.js"></script><script type="text/javascript">    $(function(){        // 预编译需要使用的模板        var aclModuleListFirstTemplate = $('#aclModuleListFirstTemplate').html();        Mustache.parse(aclModuleListFirstTemplate);        var aclModuleListNextTemplate = $('#aclModuleListNextTemplate').html();        Mustache.parse(aclModuleListNextTemplate);        var aclListTemplate = $('#aclListTemplate').html();        Mustache.parse(aclListTemplate);        // 加载部门列表        loadAclModuleList();        function loadAclModuleList() {            $.ajax({                url: "/sys/aclModule/tree.json",                success: function (result) {                    if (result.ret) {                        var rendered = Mustache.render(aclModuleListFirstTemplate, {aclModuleList: result.data});                        $('#aclModuleList').html(rendered);                        recursiveRenderAclModule(result.data);                        bindAclModuleClick();                    } else {                        $('#aclModuleList').html(result.msg);                    }                }            });        }        function recursiveRenderAclModule(aclModuleList) {            if (aclModuleList && aclModuleList.length > 0) {                $(aclModuleList).each(function (i, aclModule) {                    if (aclModuleList && aclModuleList.length > 0) {                        var rendered = Mustache.render(aclModuleListNextTemplate, {aclModuleList: aclModule.aclModuleList});                        $('#aclModule_' + aclModule.id).append(rendered);                        recursiveRenderAclModule(aclModule.aclModuleList);                    }                });            }        }        function bindAclModuleClick() {            $(".aclModule-name").click(function (e) {                e.preventDefault();                e.stopPropagation(); // 此处必须要取消冒泡,因为是个递归结构,冒泡的话会让一个点击被响应多个                loadAclList($(this).attr("data-id"));            });        }        function loadAclList(aclModuleId) {            $.ajax({                url: "/sys/acl/list.json",                data: {                    aclModuleId: aclModuleId                },                success: function (result) {                    if (result.ret) {                        var rendered = Mustache.render(aclListTemplate, {aclList: result.data.data});                        $('#aclList').html(rendered);                    } else {                        alert(result.msg);                    }                }            });        }    });</script></body></html>